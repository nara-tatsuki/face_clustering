# 顔タイプ判別モデル作成

# 概要
卒論の際に作成した、顔タイプ診断を機械学習モデルを用いて実現する。
このモデルを用いることで自分の顔タイプを簡単に判別でき、似合いを見つけることを目的とする。

# 顔タイプ分類システム
1. 顔を認識するロジックの作成
1. 下記サイトを基に機械学習モデルを用いた顔タイプ分類のロジックを作る
https://qiita.com/yuni/items/c50306bdbe856580e7cc

# 顔タイプ診断とは
メンズの顔タイプ診断は、顔の印象や特徴をもとに「似合うファッションや髪型」を提案するための方法。  
男性の場合も顔タイプは以下の8つに分類され、それぞれに合ったスタイルが異なります。

- キュートタイプ（Cute）
    - Cute Soft: 丸みがあり、柔らかく可愛い印象。カジュアルでポップなデザインやリラックス感のあるスタイルが似合う。
    - Cute Hard: 可愛らしさに加え、しっかりとした顔立ち。ストリート系や少し甘さのあるカジュアルファッションが得意。

- フレッシュタイプ（Fresh）
爽やかで自然体な印象が特徴。
    - Fresh Soft: ナチュラルで柔らかい雰囲気。シンプルでカジュアルなスタイルやスポーティなファッションが似合う。
    - Fresh Hard: スッキリとした整った顔立ち。直線的なデザインやキレイめカジュアルが得意。

- エレガントタイプ（Elegant）
大人っぽく上品で洗練された印象が特徴。

    - Elegant Soft: 華やかさと柔らかさがあり、少し親しみやすい雰囲気。上質で落ち着いたファッションや、ジャケットスタイルが似合う。
    - Elegant Hard: シャープで高級感のある顔立ち。モダンなデザインやスーツスタイルが特に映える。

- クールタイプ（Cool）
知的でスタイリッシュ、クールな印象が特徴。

    - Cool Soft: シャープさの中に柔らかさを感じる顔立ち。ミニマルなファッションやモノトーンコーデが似合う。
    - Cool Hard: 洗練されていてキリッとした印象。モード系ファッションや直線的でハイエンドなスタイルが得意。

# 使い方
### 画像収集→顔部分切り抜き
1. search_wordに収集したい芸能人の名前、dir_nameにその芸能人の顔タイプを入力
1. main.pyの26行目~31行目をコメントアウトして実行
1. ○○_trimフォルダの切り抜かれた顔が正しくないものを手作業で削除する

### 画像水増し
1. main.pyの21行目~24行目をコメントアウトして実行
1. ○○_testの画像をtest_imageへ移動
1. ○○_modelの画像をmodel_imageへ移動

### モデル作成
1. models.pyを実行

### 顔タイプ診断
1. sample_imageフォルダに診断したい画像を格納する
1. image_decideを実行

# 作成手順
1. 画像収集  
GCPのSearch API使って画像収集
※1日100リクエストなので注意

1. 画像加工  
OpenCVのライブラリを使って顔検出＆切り抜き
精度低くて切り抜きミスしているものは削除

1. 画像水増し  
反転・コントラスト調整等を用いて同じ画像を水増しする  
学習サンプルを増やすことでモデルの精度が上昇する

1. 機械学習  
Kerasライブラリ：高レベルのAPIを用いて機械学習モデルを作成する

### 今後の課題
-  リファクタリング
    - test_image,model_imageへのファイル移動
    - 画像フォルダの削除
-  Webアプリ化
-  機械学習モデルの性能向上
-  どこに属しているかをグラフ上にマッピング